<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Transport Considerations for IP and UDP Proxying in MASQUE</title>
<meta content="Magnus Westerlund" name="author">
<meta content="Marcus Ihlar" name="author">
<meta content="Zaheduzzaman Sarker" name="author">
<meta content="Mirja Kuehlewind" name="author">
<meta content="
       The HTTP Connect method uses back-to-back TCP connections to and from a proxy.
Such a solution takes care of many transport aspects as well as IP Flow related
concerns. With UDP and IP proxying on the other hand, there are several
per-packet and per-flow aspects that need consideration to preserve the
properties of end- to-end IP/UDP flows. The aim of this document is to highlight
and provide solutions for these issues related to UDP and IP proxying. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="draft-westerlund-masque-transport-issues-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.9.5
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.0
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 52.0.0
    six 1.15.0
-->
<link href="draft-westerlund-masque-transport-issues.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  scrollbar-color: #bbb #eee;
}
@media (prefers-color-scheme: dark) {
html {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
#title, #rfcnum {
  margin: 1.5em 0 0.2em;
}
#rfcnum + #title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Transport Considerations for MASQUE</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Westerlund, et al.</td>
<td class="center">Expires 13 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">MASQUE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-westerlund-masque-transport-issues-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-12" class="published">12 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-13">13 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Westerlund</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Ihlar</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">Z. Sarker</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Kuehlewind</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Transport Considerations for IP and UDP Proxying in MASQUE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The HTTP Connect method uses back-to-back TCP connections to and from a proxy.
Such a solution takes care of many transport aspects as well as IP Flow related
concerns. With UDP and IP proxying on the other hand, there are several
per-packet and per-flow aspects that need consideration to preserve the
properties of end- to-end IP/UDP flows. The aim of this document is to highlight
and provide solutions for these issues related to UDP and IP proxying.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  MASQUE Working Group mailing list (masque@ietf.org),
  which is archived at <a href="https://mailarchive.ietf.org/arch/browse/masque/">https://mailarchive.ietf.org/arch/browse/masque/</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/gloinul/draft-westerlund-masque-transport-issues">https://github.com/gloinul/draft-westerlund-masque-transport-issues</a>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulBare compact ulEmpty">
<li class="toc ulBare compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-definitions" class="xref">Definitions</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-http-connect" class="xref">HTTP Connect</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-turn" class="xref">TURN</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-http-connect-udp" class="xref">HTTP Connect-UDP</a></p>
</li>
            </ul>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-review-of-ip-header" class="xref">Review of IP Header</a></p>
<ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-base-header-fields" class="xref">Base Header Fields</a></p>
<ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-version" class="xref">Version</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-dscp" class="xref">DSCP</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="xref">2.1.3</a>.  <a href="#name-ecn" class="xref">ECN</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a href="#section-2.1.4" class="xref">2.1.4</a>.  <a href="#name-identification-flags-and-fr" class="xref">Identification, Flags, and Fragmentation offset (IPv4 Only)</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.5">
                    <p id="section-toc.1-1.2.2.1.2.5.1"><a href="#section-2.1.5" class="xref">2.1.5</a>.  <a href="#name-flow-label-ipv6-only" class="xref">Flow Label (IPv6 Only)</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.6">
                    <p id="section-toc.1-1.2.2.1.2.6.1"><a href="#section-2.1.6" class="xref">2.1.6</a>.  <a href="#name-total-length-payload-length" class="xref">Total Length / Payload length</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.7">
                    <p id="section-toc.1-1.2.2.1.2.7.1"><a href="#section-2.1.7" class="xref">2.1.7</a>.  <a href="#name-protocol-next-header" class="xref">Protocol / Next Header</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.8">
                    <p id="section-toc.1-1.2.2.1.2.8.1"><a href="#section-2.1.8" class="xref">2.1.8</a>.  <a href="#name-time-to-live-hop-limit" class="xref">Time to Live / Hop Limit</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.9">
                    <p id="section-toc.1-1.2.2.1.2.9.1"><a href="#section-2.1.9" class="xref">2.1.9</a>.  <a href="#name-header-checksum-ipv4-only" class="xref">Header Checksum (IPv4 Only)</a></p>
</li>
                  <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.1.2.10">
                    <p id="section-toc.1-1.2.2.1.2.10.1"><a href="#section-2.1.10" class="xref">2.1.10</a>. <a href="#name-source-and-destination-addr" class="xref">Source and Destination Address</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-ipv4-options-header" class="xref">IPv4 Options Header</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-ipv6-extension-headers" class="xref">IPv6 Extension Headers</a></p>
</li>
            </ul>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-review-of-udp-header" class="xref">Review of UDP Header</a></p>
<ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-source-and-destination-port" class="xref">Source and Destination Port</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-udp-length" class="xref">UDP Length</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-udp-checksum" class="xref">UDP Checksum</a></p>
</li>
            </ul>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-icmp" class="xref">ICMP</a></p>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-maximum-transmission-unit-m" class="xref">Maximum Transmission Unit (MTU)</a></p>
<ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-ipv6-fragmentation" class="xref">IPv6 Fragmentation</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ipv4-fragmentation" class="xref">IPv4 Fragmentation</a></p>
</li>
            </ul>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-summary" class="xref">Summary</a></p>
<ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-udp-flow-information-and-co" class="xref">UDP Flow Information and configuration</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-potential-per-packet-inform" class="xref">Potential Per Packet Information</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-event-based-interactions" class="xref">Event based Interactions</a></p>
</li>
            </ul>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-conclusion" class="xref">Conclusion</a></p>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="toc compact ulEmpty ulBare">
<li class="toc compact ulEmpty ulBare" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="toc compact ulEmpty ulBare" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulBare compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document examines several aspects related to UDP <span>[<a href="#RFC0768" class="xref">RFC0768</a>]</span> over IP
<span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span> <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> (IP/UDP) flows when they are proxied according to the
MASQUE proposal over QUIC and using HTTP CONNECT method for flow establishment
(Connect-UDP) <span>[<a href="#I-D.ietf-masque-connect-udp" class="xref">I-D.ietf-masque-connect-udp</a>]</span>. It also looks at how
transport protocols on top of UDP use this information and contrast that with
both the HTTP Connect method <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span> using either TCP <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span> or QUIC
<span>[<a href="#RFC9000" class="xref">RFC9000</a>]</span> as well as the methods used by the TURN protocol
<span>[<a href="#RFC8656" class="xref">RFC8656</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Aspects discussed include ECN <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span>, Differentiated Services Field and its
codepoint (DSCP) <span>[<a href="#RFC2474" class="xref">RFC2474</a>]</span>, Fragmentation and MTU, ICMP <span>[<a href="#RFC0792" class="xref">RFC0792</a>]</span>, IPv6 FLOW
ID <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>, IPv6 Extension headers, and IPv4 Options <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span>. This
document also discusses the use of the UDP checksum and the UDP Length field
usage related to UDP Options <span>[<a href="#I-D.ietf-tsvwg-udp-options" class="xref">I-D.ietf-tsvwg-udp-options</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="definitions">
<section id="section-1.1">
        <h3 id="name-definitions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.1-1.1">UDP Flow: A sequence of UDP packets sharing a 5-tuple.<a href="#section-1.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.2">ECN: Explicit Congestion Notification <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span>.<a href="#section-1.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.3">DSCP: Differentiated Service Code Point <span>[<a href="#RFC2474" class="xref">RFC2474</a>]</span>.<a href="#section-1.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.4">Proxy: This document uses proxy as synonym for the MASQUE Server or an HTTP
proxy, depending on context.<a href="#section-1.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.5">Client: The endpoint initiating a MASQUE tunnel and UDP/IP relaying with the
proxy.<a href="#section-1.1-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.6">Target: A remote endpoint the client wishes to establish bi-directional 
communication with.<a href="#section-1.1-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.7">UDP proxying: A proxy forwarding data to a target over an UDP
"connection". Data is decapsulate at the proxy and amended by a UDP and IP
header before forwarding to the target. Datagram boundaries need to be
preserved or signalled between the client and proxy.<a href="#section-1.1-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.8">IP proxying: A proxy forwarding data to a target over an IP
"connection". Data is decapsulate at the proxy and amended by a IP header
before forwarding to the target. Packet boundaries need to be preserved or
signalled between the client and proxy.<a href="#section-1.1-1.8" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-the-nodes-and-their-address"></span><div id="fig-node-model">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-1.1-2.1">
<pre>
Address = IP address + UDP port

                     Target Address --+
                                       \
+--------+           +--------+         \ +--------+
|        |  Path #1  |        | Path #2  V|        |
| Client |&lt;---------&gt;|  Proxy |&lt;---------&gt;| Target |
|        |          ^|        |^          |        |
+--------+         / +--------+ \         +--------+
                  /              \
                 /                +-- Proxy's external address
                /
               +-- Proxy's service address
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-nodes-and-their-address" class="selfRef">The nodes and their addresses</a>
          </figcaption></figure>
</div>
<p id="section-1.1-3"><a href="#fig-node-model" class="xref">Figure 1</a> provides an overview figure of the involved nodes,
i.e. Client, Proxy, and Target, that are discussed below. We use the name target
for the node or endpoint the client intends to communicate with via the proxy.
There are also two network paths. Path #1 is the client to proxy path, where the
MASQUE protocol will be used over an HTTP/3 session, usually over QUIC, to
tunnel IP/UDP flow(s). Path #2 is the path between the Proxy and the Target.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">The client will use the proxy's service address to establish a transport
connection on which to communicate with the proxy using the MASQUE protocol. The
MASQUE protocol will be used to establish the relaying of a IP/UDP flow from the
client using as the source address the proxy's external address and sending to
the target address. In addition, after establishment, the reverse is also
configured on the proxy; IP/UDP packets sent from the target address to the
proxy's external address will be relayed to the client.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-connect">
<section id="section-1.2">
        <h3 id="name-http-connect">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-http-connect" class="section-name selfRef">HTTP Connect</a>
        </h3>
<p id="section-1.2-1">The HTTP Connect method <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span> is defined such that the HTTP proxy that 
receives the request will set up a TCP connection towards a provided (or 
resolved) target address. After the TCP connection has been established, the 
proxy will connect the byte stream from the client to the byte stream of the new 
TCP connection. On byte stream level this is only tunneling. On the transport 
level on the other hand, two distinct transport connections are established. 
If the client to proxy connection is HTTP/3, i.e. over QUIC, the basic HTTP 
Connect method will still lead to TCP connection establishment from proxy to the 
target servers. In this case the client to proxy QUIC stream's byte stream is 
connected to the proxy to server TCP connection. For simplicity and clarify the 
rest of the document will use back to back TCP sessions as a comparison.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Due to the byte stream semantics and the use of transport protocol proxying, 
most of the transport implications of the header fields and their values are 
handled on a per path basis, e.g. response to ECN Congestion Experienced (CE) 
marks. Some information that may be end-to-end related, such as DSCP values, can 
be copied or translated between the connections if supported by the proxy. MTU 
is mostly irrelevant and handled fully due to the byte stream nature of the data 
flowing in the connection. If the MTU differs between the two paths the number
of packets required to send a particular data object may differ as well. 
However, the impact of that is small and depends on the amount of buffering
between the two connections. There is no requirement to have a one-to-one 
correspondence of packets between the two TCP connections.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="turn">
<section id="section-1.3">
        <h3 id="name-turn">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-turn" class="section-name selfRef">TURN</a>
        </h3>
<p id="section-1.3-1">"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal
Utilities for NAT (STUN)" <span>[<a href="#RFC8656" class="xref">RFC8656</a>]</span> is a solution for relaying UDP
datagrams. However, it is a hybrid between a purely encapsulating tunnel and
proxying. A somewhat simplified description of the protocol follows below.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">A client makes a TURN request over a TCP/TLS connection to a TURN server to 
authenticate itself and acquire a long-term secret.
Note that subsequent requests are secured using keying material from the long 
term secret exchange. Next, the client can send a request over UDP to be 
allocated a UDP port number on one of the server's external IP addresses. After 
that, the client knows the IP address and UDP port number that will be used for 
the TURN server's side of any UDP flow sent to or received from the remote 
target.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">A TURN client can send UDP packets in two ways. The first solution is to include
a send indication for each UDP packet to be relayed. The send indications 
contains the target destination address and port. The other solution is to 
create a binding, where a channel ID between the client and TURN server is bound 
to a specific 5-tuple from the TURN Server to the target destination. The 
established channel is bi-directional. When a channel has been established, UDP 
packets can be relayed with a low overhead of 4 bytes.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">To receive UDP packets on the allocated port, the client must specify what
source address and port (target address) is to be allowed, this is called
establishing a permission. Binding a channel creates a permission at the same
time. When the TURN server receives a UDP packet from an external source where
permission exists but no channel, it will relay the data using a DATA
indication, which includes the source address.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5">A relevant aspect for the rest of the discussion in this document is that TURN 
has a one to one mapping between IP/UDP/TURN messages between client and
TURN server and the IP/UDP packet received or sent on the external side. Also,
though TURN messages and indications include header information in the UDP 
payload, there are distinct IP/UDP headers on each side of the TURN server.
Because of this the TURN protocol is able to preserve the per flow and per
packet functionalities that exist in IP/UDP headers. For instance, ECN and DSCP
markings associated with specific packets are preserved by the relay by copying 
or translating them from incoming packets to outgoing packets.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-connect-udp">
<section id="section-1.4">
        <h3 id="name-http-connect-udp">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-http-connect-udp" class="section-name selfRef">HTTP Connect-UDP</a>
        </h3>
<p id="section-1.4-1">The MASQUE WG is chartered to work on the tunneling of UDP datagrams in a QUIC 
connection between client and a MASQUE server (We will refer to the MASQUE 
server as a proxy in the rest of this document to align with the basic HTTP
Connect terminology). The proxy forwards tunneled UDP payload to the correct
target address. An HTTP Connect-UDP request is used to establish the tunnel and 
provide the required addressing information.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">In the review performed in this document we make the assumption that
it is desirable to minimize the per-packet overhead. Specifically, we
assume that IP/UDP header information from packets exchanged between
the proxy and target will not be sent within the tunnel. The initial
relay exchange establishment needs to be performed for each target the
client wants to communicate with, i.e.  one relay exchange per IP/UDP
flow on the proxy to target path. Keeping this state in the proxy on a
per UDP flow basis appears trivial. Therefore, the review will
determine what IP/UDP state is required per flow and what is per per
packet information.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">In this review we also aim to identify the impact on the end-to-end flows by 
using QUIC as a tunneling protocol, both in stream and/or datagram mode. 
Properties of IP/UDP flows and higher level transport protocols such as QUIC or 
RTP will be considered.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">Two high level observations need to be made when comparing Connect-UDP to TURN.
The first is that QUIC is a proper transport protocol with congestion control. 
This means that there might not be a one-to-one mapping between events that
impact the transport, such as congestion indications, on either path relative to 
the proxy. The second observation is that tunneled UDP datagrams can be 
coalesced in a single UDP datagram with either multiple QUIC packets, or 
multiple QUIC datagram frames in a single QUIC packet. If reliable streams are 
used instead of datagram frames, then a UDP payload may even be fragmented over 
multiple UDP packets containing QUIC packets.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">This all motivates a very careful consideration of the IP and UDP header
information and how that needs to be handled on flow level or per packet level
to avoid breaking end-to-end transport properties for the flow.<a href="#section-1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="review-of-ip-header">
<section id="section-2">
      <h2 id="name-review-of-ip-header">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-review-of-ip-header" class="section-name selfRef">Review of IP Header</a>
      </h2>
<div id="base-header-fields">
<section id="section-2.1">
        <h3 id="name-base-header-fields">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-base-header-fields" class="section-name selfRef">Base Header Fields</a>
        </h3>
<p id="section-2.1-1">This section reviews the header fields in IPv4 <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span> and IPv6
<span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>. It will note which field are version specific. Size differences are 
not considered in the review as it is focused on functionality and impact.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div id="version">
<section id="section-2.1.1">
          <h4 id="name-version">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-version" class="section-name selfRef">Version</a>
          </h4>
<p id="section-2.1.1-1">The proxy needs to know which IP version to use on the proxy to target path. 
If an explicit IP address is included in the Connect-UDP request, the proxy
would know this directly from the IP address format. In the case where a domain name is 
used to obtain the target IP address, the IP version needs to be specified or
be based on preferences when resolving the domain name.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">It should be noted that different IP versions may be used on the two paths
requiring the proxy to do translation. This can also lead to scenarios whereby
version specific information carried on one path does not translate to the
version used on the other path.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dscp">
<section id="section-2.1.2">
          <h4 id="name-dscp">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-dscp" class="section-name selfRef">DSCP</a>
          </h4>
<p id="section-2.1.2-1">Diffserv code points are primarily used to indicate forwarding behavior. 
Codepoints on IP/UDP flows on the proxy to target path are either set on a flow 
level or packet level. Codepoints set on a flow level are set at flow 
instantiation and can be updated during ongoing relaying.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">A DSCP value received on IP/UDP packets in the target to proxy direction may be 
propagated to the Proxy to client path. However, that is problematic when the 
datagram is tunneled in QUIC. The DART considerations <span>[<a href="#RFC7657" class="xref">RFC7657</a>]</span> for 
connection oriented transport applies here. If multiple DSCPs are used for a 
single connection, then there would be a need for having separate congestion
control states for the different forwarding behaviors, which would likely 
require QUIC protocol extensions. The same issue exists for packets sent by the
client on the client to proxy path.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">Different forwarding behaviors in both directions of the path connecting the
client and the proxy could be enabled without a QUIC extension by establishing
individual QUIC connections per forwarding behavior used. However, this requires
that the proxy is able to bind multiple QUIC connections received from the
client into a single IP/UDP flow on the proxy to target path. This could have
significant security model implications as authorization would be needed to add
subsequent bindings to an existing flow.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2-4">Let's consider the capability for the proxy to send packets with packet-level
DSCP marks towards the target. That would require at a minimum a per packet
indication mechanism and would enable different forwarding behaviors on the
proxy to target path. Similarly, a per packet mechanism would be needed for the
proxy to be able to relay DSCP values received from the target towards the
client. The usefulness of the latter would be to ensure that the transport
protocol on top of MASQUE is able to determine whether there is a need for
multiple congestion control states for different sub-sets of packets within the
received IP/UDP flow. WebRTC IP/UDP flows could have this property.<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-2.1.2-5">The most basic DSCP relay capability would be to set the same DSCP value on all
IP/UDP packets sent by the proxy to the same target for a specific IP/UDP flow.
This capability would only require signalling of the desired value at flow
establishment. A mechanism to update the DSCP value for an ongoing flow should
also be considered.<a href="#section-2.1.2-5" class="pilcrow">¶</a></p>
<p id="section-2.1.2-6">Another issue with DSCP mapping to forwarding behaviors is that the mappings are 
defined per network location, typically within one administrative domain of 
routing. Therefore they may be remapped on the different paths relative to the 
proxy. When the client and proxy reside in two different administrative domains
there will be an additional challenge for the client to use the right DSCP 
value. Thus, support for DSCP in the MASQUE protocol should either be limited to 
consider per hop behavior or the use of a mapping table such that the proxy can
translate an incoming DSCP value to a locally used value.<a href="#section-2.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecn">
<section id="section-2.1.3">
          <h4 id="name-ecn">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-ecn" class="section-name selfRef">ECN</a>
          </h4>
<p id="section-2.1.3-1">The Explicit Congestion Notification (ECN) <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> field carries per packet
path signals about congestion. The discussion of ECN capability can be split
into two parts, one for each path relative to the proxy. On the client to proxy
path the QUIC connection used for tunneling the UDP datagrams can enable and use
ECN on that path specifically. Any congestion experienced (ECN-CE) marking on
that path impacts the congestion window of the client to proxy QUIC connection,
thus indirectly affecting the end-to-end flow.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.3-2">The capability to use ECN on the proxy to target path requires proxy protocol
support. This will enable the end-to-end usage of ECN in the upper layer
transport protocol. To support ECN end-to-end when using MASQUE proxy two
functionalities need to exist.<a href="#section-2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.1.3-3">First, the capability of setting the ECN field value (Not-ECT, ECT(1), ECT(0)) 
on any IP/UDP packets sent from proxy to target. This value can be set initially
but may be changed during ongoing IP/UDP flow proxying, as the end-to-end
transport may subsequently determine that the path is not ECN capable.<a href="#section-2.1.3-3" class="pilcrow">¶</a></p>
<p id="section-2.1.3-4">Secondly, the client must be able to receive per packet indications of the ECN
field value for every packet received by the proxy from the target. This ensures
that the upper layer transport protocol receives ECN information per relayed UDP
datagram. The information will be used to react to ECN-CE (Congestion 
Experienced) marks and for validation of the ECN path capability.<a href="#section-2.1.3-4" class="pilcrow">¶</a></p>
<p id="section-2.1.3-5">A solution like TURN's <span>[<a href="#RFC8656" class="xref">RFC8656</a>]</span> translation of ECN markings between the two
paths is not possible for multiple reasons. First, ECN marks on the client to
proxy path will be consumed and reacted to by the QUIC connection used for 
tunneling. Second, the previously discussed lack of a one-to-one relationship of
IP/UDP packets prevents accurate tracking of the ECN markings and will make
the end-to-end validation fail. Therefore additional explicit signaling 
between the proxy and the client would be needed.<a href="#section-2.1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identification-flags-and-fragmentation-offset-ipv4-only">
<section id="section-2.1.4">
          <h4 id="name-identification-flags-and-fr">
<a href="#section-2.1.4" class="section-number selfRef">2.1.4. </a><a href="#name-identification-flags-and-fr" class="section-name selfRef">Identification, Flags, and Fragmentation offset (IPv4 Only)</a>
          </h4>
<p id="section-2.1.4-1">These fields are used for the IPv4 fragmentation solution. The authors are of
the opinion that IP level fragmentation should be avoided. However, since there 
are no guarantees for a one-to-one packet relation between the two paths 
relative to the proxy, any IPv4 fragments will need re-assembly upon reception
by the endpoints and the proxy.<a href="#section-2.1.4-1" class="pilcrow">¶</a></p>
<p id="section-2.1.4-2">To support Path MTU Discovery the Don't Fragment (DF) bit needs to be set for all
outgoing IP/UDP packets from the proxy to the target. Per flow or per packet 
setting of this bit needs to be supported.<a href="#section-2.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow-label-ipv6-only">
<section id="section-2.1.5">
          <h4 id="name-flow-label-ipv6-only">
<a href="#section-2.1.5" class="section-number selfRef">2.1.5. </a><a href="#name-flow-label-ipv6-only" class="section-name selfRef">Flow Label (IPv6 Only)</a>
          </h4>
<p id="section-2.1.5-1">The IPv6 flow label is used by the network to identify flows, for example to
prevent a single flow to be spread over multiple paths when load balancing based
on Equal Cost Multipath (ECMP) routing <span>[<a href="#RFC6438" class="xref">RFC6438</a>]</span> is performed.
The flow label should be set by the endpoint originating the IP/UDP flow, as it 
knows when a flow qualifies for a unique IPv6 flow label. Thus, it is 
expected that one IPv6 flow label will be used for the IP/UDP flow that carries 
the client to proxy QUIC connection, and one for each IP/UDP flow established by 
the MASQUE protocol to different target addresses.<a href="#section-2.1.5-1" class="pilcrow">¶</a></p>
<p id="section-2.1.5-2">Based on the above reasoning it does not seem like there is a need for the 
MASQUE protocol to explicitly signal or indicate flow labels.<a href="#section-2.1.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="total-length-payload-length">
<section id="section-2.1.6">
          <h4 id="name-total-length-payload-length">
<a href="#section-2.1.6" class="section-number selfRef">2.1.6. </a><a href="#name-total-length-payload-length" class="section-name selfRef">Total Length / Payload length</a>
          </h4>
<p id="section-2.1.6-1">The Total Length (IPv4) / Payload length (IPv6) fields contain the size of
the IP packet, either directly for IPv4, or indirectly in IPv6 (by providing the
length after the fixed 40-byte header, i.e. for extension headers and data).<a href="#section-2.1.6-1" class="pilcrow">¶</a></p>
<p id="section-2.1.6-2">These field are necessary for the processing on reception, however it does not
need to be communicated on a per packet-basis to the client, or be provided by
the client, with a single potential exception that is discussed in the context 
of the UDP length field (<a href="#sec-udp-length" class="xref">Section 3.2</a>).<a href="#section-2.1.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-next-header">
<section id="section-2.1.7">
          <h4 id="name-protocol-next-header">
<a href="#section-2.1.7" class="section-number selfRef">2.1.7. </a><a href="#name-protocol-next-header" class="section-name selfRef">Protocol / Next Header</a>
          </h4>
<p id="section-2.1.7-1">The Protocol (IPv4) and Next Header (IPv6) fields provide the identification of 
the upper layer protocol, in this case UDP. For IPv6 one or more extension 
headers may first be identified in a chain before arriving at UDP.<a href="#section-2.1.7-1" class="pilcrow">¶</a></p>
<p id="section-2.1.7-2">The use of UDP relaying will need to be signalled explicitly to separate it from
other types of relaying, such as the IP tunneling/relaying discussed in the
MASQUE charter.<a href="#section-2.1.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="time-to-live-hop-limit">
<section id="section-2.1.8">
          <h4 id="name-time-to-live-hop-limit">
<a href="#section-2.1.8" class="section-number selfRef">2.1.8. </a><a href="#name-time-to-live-hop-limit" class="section-name selfRef">Time to Live / Hop Limit</a>
          </h4>
<p id="section-2.1.8-1">The purpose of the Time to Live (IPv4) and Hop Limit (IPv6) fields is to prevent 
packets from having an infinite life time in case of routing loops. The acronym
TTL is used from here on to describe any of these fields. TTL limits the 
number of routing hops a packet survives and should result in an ICMP message 
back to the sender when it expires. Therefore, it is possible to use TTL for 
investigating network paths.<a href="#section-2.1.8-1" class="pilcrow">¶</a></p>
<p id="section-2.1.8-2">It is not clear if such a mechanism needs to be supported in a MASQUE protocol 
context. If something like trace-route is to be supported, per packet setting
of the TTL field would be needed.<a href="#section-2.1.8-2" class="pilcrow">¶</a></p>
<p id="section-2.1.8-3">The need for echoing the TTL field value on reception of a IP/UDP packet from
the target to the client appears also very limited. The value set on
transmission of a packet is usually an operating system set default value.<a href="#section-2.1.8-3" class="pilcrow">¶</a></p>
<p id="section-2.1.8-4">The authors believe that the proxy's default values are sufficient for the
MASQUE protocol functionality.<a href="#section-2.1.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="header-checksum-ipv4-only">
<section id="section-2.1.9">
          <h4 id="name-header-checksum-ipv4-only">
<a href="#section-2.1.9" class="section-number selfRef">2.1.9. </a><a href="#name-header-checksum-ipv4-only" class="section-name selfRef">Header Checksum (IPv4 Only)</a>
          </h4>
<p id="section-2.1.9-1">The IPv4 checksum field verifies the integrity against non-intentional errors in
transmission or processing of the IP header. IPv6 lacks this checksum and 
instead relies on the transport protocol checksum.<a href="#section-2.1.9-1" class="pilcrow">¶</a></p>
<p id="section-2.1.9-2">The value is generated when an IP packet is transmitted from the proxy and 
verified on reception. No further functionality required.<a href="#section-2.1.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IP-Address">
<section id="section-2.1.10">
          <h4 id="name-source-and-destination-addr">
<a href="#section-2.1.10" class="section-number selfRef">2.1.10. </a><a href="#name-source-and-destination-addr" class="section-name selfRef">Source and Destination Address</a>
          </h4>
<p id="section-2.1.10-1">On the path from the proxy to the target, the source address will be the proxy's
external address applied when relaying the IP/UDP packets. This address will be
determined as part of the IP/UDP flow tunneling establishment and should be
signalled back to the client by the proxy. The destination address used will be
the target's IP address.<a href="#section-2.1.10-1" class="pilcrow">¶</a></p>
<p id="section-2.1.10-2">The source addresses used on the client to proxy path are only needed for the
communication between the client and proxy and are part of the QUIC connection's
state. Thus, the possibility to change it will depend on the mechanisms in QUIC
for dealing with client address migration or multi-path. Further discussion
should not be needed.<a href="#section-2.1.10-2" class="pilcrow">¶</a></p>
<p id="section-2.1.10-3">In case of IP proxying, as the proxy cannot utilize port numbers, the proxy
might need to maintain multiple external IP addresses in order to identify
different forwarding processes for packet received from multiple target
servers. If the proxy is guaranteed to be on-path between the client and server
the proxy could also conserve the client's source IP address as it's external
address.<a href="#section-2.1.10-3" class="pilcrow">¶</a></p>
<p id="section-2.1.10-4">The source and destination addresses are therefore part of the fundamental state
for IP/UDP flow relaying and need to be established at initiation.  The 2 (IP
proxying) or 5-tuple (IP/UDP proxying) from the proxy to the target and the
reverse tuple needs to be explicitly signalled.  The client either needs to
explicitly provide the target IP address or a domain name that the proxy can
resolve to a target IP address.  The proxy needs to notify the client about
which source IP address it uses when sending on the proxy to target path.<a href="#section-2.1.10-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ipv4-options-header">
<section id="section-2.2">
        <h3 id="name-ipv4-options-header">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-ipv4-options-header" class="section-name selfRef">IPv4 Options Header</a>
        </h3>
<p id="section-2.2-1">The use of IPv4 Options header on the general Internet is very limited. It is
therefore likely that no functionality is required.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ipv6-extension-headers">
<section id="section-2.3">
        <h3 id="name-ipv6-extension-headers">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-ipv6-extension-headers" class="section-name selfRef">IPv6 Extension Headers</a>
        </h3>
<p id="section-2.3-1">One IPv6 Extension header that needs discussion here is the fragmentation
header. Although it is the IP originating node that adds the fragmentation
header, the MASQUE protocol will likely need to control whether IPv6 
fragmentation should be used or not, in the same way as for the IPv4 DF bit.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">Some existing IPv6 extension headers could be added by the originating
node. Whether they require any explicit signalling or relaying of data to the 
client needs to be investigated further. Especially Hop-by-Hop options, such as 
the IPv6 Minimum Path MTU Hop-by-Hop Option <span>[<a href="#I-D.ietf-6man-mtu-option" class="xref">I-D.ietf-6man-mtu-option</a>]</span>.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">There are also some individual proposals for extension header that
might matter in the future: Network Tokens
<span>[<a href="#I-D.yiakoumis-network-tokens" class="xref">I-D.yiakoumis-network-tokens</a>]</span>, IPv6 Truncate Option
<span>[<a href="#I-D.leddy-6man-truncate" class="xref">I-D.leddy-6man-truncate</a>]</span>. Thus, consideration needs to be made if there
are necessary to future proof the Masque protocol, at least to enable future
extensions to support per packet Extension headers.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="review-of-udp-header">
<section id="section-3">
      <h2 id="name-review-of-udp-header">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-review-of-udp-header" class="section-name selfRef">Review of UDP Header</a>
      </h2>
<div id="source-and-destination-port">
<section id="section-3.1">
        <h3 id="name-source-and-destination-port">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-source-and-destination-port" class="section-name selfRef">Source and Destination Port</a>
        </h3>
<p id="section-3.1-1">For UDP proxying, the UDP destination port is used by endpoints to locate the
destination process that should consume a specific UDP datagram. Source Ports
can be used by the receiving application to separate flows based on the 5-tuple.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">As discussed in <a href="#IP-Address" class="xref">Section 2.1.10</a> the UDP source and destination ports are part
of the 5-tuple and needs to be communicated on IP/UDP flow establishment.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-udp-length">
<section id="section-3.2">
        <h3 id="name-udp-length">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-udp-length" class="section-name selfRef">UDP Length</a>
        </h3>
<p id="section-3.2-1">The UDP length field specifies the UDP payload length in octets.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The UDP length field normally indicates that the UDP payload fills up the 
remainder of the IP packet. However, this is not always the case. Specifically,
UDP options <span>[<a href="#I-D.ietf-tsvwg-udp-options" class="xref">I-D.ietf-tsvwg-udp-options</a>]</span> are designed to make use of the 
surplus area between the end of the UDP data section and the end of the IP 
packet.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Thus, for the MASQUE protocol to preserve the capability to carry UDP options in
UDP relaying this surplus area and the UDP payload data length field need to
transmitted from client to proxy in both directions.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="udp-checksum">
<section id="section-3.3">
        <h3 id="name-udp-checksum">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-udp-checksum" class="section-name selfRef">UDP Checksum</a>
        </h3>
<p id="section-3.3-1">The UDP checksum verifies the UDP datagram headers and payload and the 
pseudo header with IP layer information. The UDP checksum should always be
verified by the receiving party. The UDP checksum may also be set to zero to
provide no verification. This is primarily used by tunnel encapsulation formats.
If it is desired to send IP/UDP flows from the proxy to the target address with
a zero UDP checksum, the MASQUE protocol needs to support an indication of this
desire.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The use of zero UDP checksum for IPv6 is more restricted than for IPv4 due to
the lack of a IP header checksum <span>[<a href="#RFC6936" class="xref">RFC6936</a>]</span>.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The authors do not believe it is necessary to be able to send IP/UDP datagrams 
with a zero UDP checksum. It is also not necessary to relay the UDP checksum
generated by the target, since the QUIC protocol will provide stronger 
cryptographic integrity verification of the UDP datagram payload. Also, for the 
target generated checksum to be meaningful to the client the complete datagram
and pseudo header would need to be reconstructed, which in would likely require
extra processing and copying of data. Though some cases of erroneous handling of
IP/UDP header fields by the MASQUE protocol could be detected in this way, it is
not deemed to be worth the effort.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">For the packets the client sends to be relayed to the target destination, having
the client create a UDP checksum would provide some protection against
processing or implementation errors, although the overhead and extra processing
is likely not worth the effort.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">In addition the calculation and verification of the transport header checksum is
one of these aspects that can be offloaded to hardware in a proxy.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="icmp">
<section id="section-4">
      <h2 id="name-icmp">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-icmp" class="section-name selfRef">ICMP</a>
      </h2>
<p id="section-4-1">Internet Control Message Protocol (ICMP) <span>[<a href="#RFC0792" class="xref">RFC0792</a>]</span><span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span> messages are
useful hints on why sent IP packets appear to disappear in the network. 
Especially for what might appear to be intermittent issues, such as exceeding 
the MTU of the path.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Lets start with clarifying which ICMP messages may be relevant to handle in the
MASQUE protocol. The primary concern is to ensure that the client receives any 
ICMP responses that are sent back to the proxy as result of packets the client 
had relayed through the proxy towards the target destination. The proxy should
validate and identify ICMP messages that relate to a particular IP/UDP flow that
the proxy sends. The relevant ICMP information, i.e. Type and Code as well as
any included bytes from the packets that can be used to identify the actual
IP/UDP packet in the client, should be sent to the client. Such a functionality
would enable the the client to receive Packet Too Big messages that speeds up
Path MTU Discovery (<a href="#sec-mtu" class="xref">Section 5</a>). It also enables the client to learn when
there appears to be no one at the target address, i.e. the port, host or network
unreachable codes.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">IP/UDP packets reaching the proxy from a target address may result in that ICMP
messages are sent back to the target. For example a port unreachable message
would be sent if a packet arrives after the client has terminated the tunneling
session.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Any ICMP packets that result from IP/UDP packets exchanged between the client
and the proxy, related to the QUIC connection is to be validated and consumed by
the QUIC implementation.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Thus, depending on the ICMP message, the MASQUE protocol needs to consider a
mechanism for the proxy to indicate to the client that it has received and
validated ICMP messages. If the ICMP message indicates a connection failure,
HTTP response error codes can be used. However, for HTTP Connect-UDP the
response code was sent when the UDP socket was created, while an ICMP message
would only be received after UDP packets have been relayed.<a href="#section-4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-mtu">
<section id="section-5">
      <h2 id="name-maximum-transmission-unit-m">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-maximum-transmission-unit-m" class="section-name selfRef">Maximum Transmission Unit (MTU)</a>
      </h2>
<p id="section-5-1">The MTU available for the UDP payload depends on whether the QUIC connection
uses datagrams or streams to carry the UDP payload on the client to proxy
path. When streams are used, the outer QUIC connection can fragment and
re-assembly UDP Payloads of any size. In this case any MTU issues will arise on
the proxy to target path.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">When using datagrams, unless the QUIC datagram extension provides a fragmentation
solution, then the outer QUIC connection will provide a MTU that is dependent on
the largest datagram payload that can be transmitted. A potential issue is that
this might be variable over time, both due to underlying path changes, and to
variable elements of the QUIC protocol. However, a base overhead from the QUIC 
headers should be possible to calculate based on the maximum QUIC packet size. 
Depending on the amount of per packet information needed to be provided
additional headroom for the MASQUE encapsulation may be required.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">To enable PMTUD discovery certain aspects are needed or greatly simplify the
process.<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">Ensure that the DF bit is set to Don't Fragment on outgoing IPv4/UDP packets
from the proxy to the target. For IPv6 the use of the fragmentation header
needs to be prevented.<a href="#section-5-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.2">Have the proxy signal back to the client its current interface MTU limit for
packets that will be sent from proxy to target.<a href="#section-5-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.3">Have the tunneling QUIC connection expose the current MTU for datagrams to the
MASQUE implementation. This is likely dynamic and can be updated at any
point.<a href="#section-5-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.4">Returning ICMP Packet Too Big (PTB) message from the proxy to the
client when packets are dropped due to MTU on the proxy to target path.<a href="#section-5-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-5">It should be noted that unless the QUIC datagram extension provides a 
fragmentation mechanism this will in many scenarios be the most likely MTU 
bottleneck and there is no work around for it, the IP/UDP tunneled traffic will 
need to fit or be dropped.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="ipv6-fragmentation">
<section id="section-5.1">
        <h3 id="name-ipv6-fragmentation">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-ipv6-fragmentation" class="section-name selfRef">IPv6 Fragmentation</a>
        </h3>
<p id="section-5.1-1">Reassembly of received traffic will occur on each node, Client, Proxy, and
Target. The need for IP level fragmentation should be avoided, by having the
working MTU be propagated up. Initial MTU signaling should exist for the
flow. However, this is potentially dynamic and a PMTUD process running for the 
outer QUIC tunnel on the client to proxy path will update the supported MTU.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">An option for controlling if fragmentation should occur or not by the Proxy
should be considered.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ipv4-fragmentation">
<section id="section-5.2">
        <h3 id="name-ipv4-fragmentation">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ipv4-fragmentation" class="section-name selfRef">IPv4 Fragmentation</a>
        </h3>
<p id="section-5.2-1">As IPv4 fragmentation is flexible and allows an on-path node to fragment a
packet, enabling fragmentation may reduce the MTU issues. However, Path MTU
Discovery is recommended instead, for the following reasons:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">Fragmentation increases the packet loss rate.<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.2">IP fragments do not traverse NATs and Firewalls well. Which is especially
relevant for MASQUE as significant deployments will be clients in access or
residential networks that have NATs or Firewalls on the path from the client
to the proxy.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="summary">
<section id="section-6">
      <h2 id="name-summary">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-summary" class="section-name selfRef">Summary</a>
      </h2>
<p id="section-6-1">Lets sum up the aspects of the IP/UDP header fields and related protocols
in a couple of categorizes.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="udp-flow-information-and-configuration">
<section id="section-6.1">
        <h3 id="name-udp-flow-information-and-co">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-udp-flow-information-and-co" class="section-name selfRef">UDP Flow Information and configuration</a>
        </h3>
<p id="section-6.1-1">This section contains header fields whose value either will be static for a
given IP/UDP flow, apply until changes, or can be used as default values when
per packet values are not given.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">First of all, the IP source and destination address as well as UDP source and port
information is directly related to the establishment of a bi-directional IP/UDP 
flow between proxy and the target. The desired IP version also needs to be 
indicated if the address is expressed as hostname, but otherwise would be given 
by the format of the address. The target always needs to be provided by the 
client. Since there are cases where the client would need to know the external 
address used by the proxy towards the target, there needs to be a way for the 
client to request this information.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The upper layer protocols between the client and the target might have different
capabilities of using ECN. Therefore it is necessary to be able to signal 
whether the ECN fields in proxy to target packets should be set to Not-ECT, 
ECT(0) or ECT(1).<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">If a DSCP marking other than 0, i.e. best effort, is desired then a default value
could be set as part of the relay establishment. This value could potentially be
overridden on a per packet basis or be changed at a future point in the relayed
flows lifetime.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">A don't fragment setting could likely be defaulted to be always true. However,
we invite further discussion if there are cases where it would be better to 
enable IP level fragmentation for some packets, or for all.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">The Hop Limit could likely be using node default values, unless someone raises
a use case where they actually want to modulate the value on per packet basis or
set an explicit value for the IP/UDP flow.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">The MTU known by the proxy towards the indicated target should be signalled
back at relay establishment by the proxy.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="potential-per-packet-information">
<section id="section-6.2">
        <h3 id="name-potential-per-packet-inform">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-potential-per-packet-inform" class="section-name selfRef">Potential Per Packet Information</a>
        </h3>
<p id="section-6.2-1">This section contains information that would be necessary to associate with a
specific packet when the client request sending or the proxy relays a received
packet.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">For each packet the proxy receives the ECN field's value need to be relayed to
the client so that the upper layer can respond to either a CE marking indicating
congestion, or any remarking.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">There are examples where IP/UDP flows contain packets that do not have uniform DSCP
marking. To enable sending of such streams, any DSCP value other the default
value would need to be indicated by the client to the proxy.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">If it is desired to verify the UDP Checksum in the client to avoid any potential
errors the MASQUE protocol implementation may cause the received UDP checksum
value would need to be relayed to the client. The UDP checksum value could also
be calculated by the client and included.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">To support UDP Options, the UDP option and their values needs to be signalled.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">If support for including IPv6 Extension Headers that needs client side information
then the extension header information would need to be indicated by the client and
also tunnelled.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="event-based-interactions">
<section id="section-6.3">
        <h3 id="name-event-based-interactions">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-event-based-interactions" class="section-name selfRef">Event based Interactions</a>
        </h3>
<p id="section-6.3-1">This section summarizes information that are triggered by events and not directly
connected to a specific packet in the IP/UDP flow being relayed. Instead these
are more of the nature of asynchronous events caused by the network, the upper
layer transport protocol, or application.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The ECN setting for packets  sent by the proxy to the target may need to change. 
If the upper layer transport protocol determines that the end-to-end path is not 
ECN capable it will need to change an ECT marking to Not-ECT. Some protocols may 
defer probing for ECT capability until after some initial handshake and packet 
exchange has occurred.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The upper layer application may change its desired forwarding behavior for the
packets in the IP/UDP stream, thus the need for the client to change the default
applied DSCP value on packets sent by the proxy to target.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">The reception of ICMP messages by the proxy will likely be the result of a
packet sent to the target but the cause is likely in the network. When this
occurs the client needs to be informed of this ICMP message, especially
when this event leads to a connection failure.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">The proxy may detect an MTU change on the proxy to target path due to received
ICMP messages that are consumed in the IP stack of the proxy and affecting the
MTU for outgoing packets. Thus, the proxy may need to indicate to the client
that it no longer can send non-fragmented packets larger than the new MTU.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conclusion">
<section id="section-7">
      <h2 id="name-conclusion">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-conclusion" class="section-name selfRef">Conclusion</a>
      </h2>
<p id="section-7-1">This document shows that many of the fields in the IP/UDP header can be
signaled initially at flow establishment. Especially IP addresses and potentially ports
need to be communicated as those also need to be used for flow identification. 
It also shows that certain field 
values or related information needs to be relayed or signalled based on
asynchronous application or network events. Other field information could need
per packet relaying. The latter requires a more active bidirectional 
communication channel between the proxy and the client.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">These aspects need to be taken into account in the future protocol development
of the CONNECT-UDP method to ensure that the MASQUE protocol doesn't prevent
future IP and transport protocol evolution.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-masque-connect-udp">[I-D.ietf-masque-connect-udp]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span>, <span class="refTitle">"The CONNECT-UDP HTTP Method"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-masque-connect-udp-03</span>, <time datetime="2021-01-05" class="refDate">5 January 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-masque-connect-udp-03">https://datatracker.ietf.org/doc/html/draft-ietf-masque-connect-udp-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-udp-options">[I-D.ietf-tsvwg-udp-options]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Transport Options for UDP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-udp-options-13</span>, <time datetime="2021-06-19" class="refDate">19 June 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tsvwg-udp-options-13">https://datatracker.ietf.org/doc/html/draft-ietf-tsvwg-udp-options-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc768">https://datatracker.ietf.org/doc/html/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc791">https://datatracker.ietf.org/doc/html/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0792">[RFC0792]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Control Message Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 792</span>, <span class="seriesInfo">DOI 10.17487/RFC0792</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc792">https://datatracker.ietf.org/doc/html/rfc792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2474">[RFC2474]</dt>
        <dd>
<span class="refAuthor">Nichols, K.</span>, <span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"</span>, <span class="seriesInfo">RFC 2474</span>, <span class="seriesInfo">DOI 10.17487/RFC2474</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc2474">https://datatracker.ietf.org/doc/html/rfc2474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3168">[RFC3168]</dt>
        <dd>
<span class="refAuthor">Ramakrishnan, K.</span>, <span class="refAuthor">Floyd, S.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span class="seriesInfo">DOI 10.17487/RFC3168</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc3168">https://datatracker.ietf.org/doc/html/rfc3168</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8200">https://datatracker.ietf.org/doc/html/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
      <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc9000">https://datatracker.ietf.org/doc/html/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-6man-mtu-option">[I-D.ietf-6man-mtu-option]</dt>
        <dd>
<span class="refAuthor">Hinden, R. M.</span> and <span class="refAuthor">G. Fairhurst</span>, <span class="refTitle">"IPv6 Minimum Path MTU Hop-by-Hop Option"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6man-mtu-option-05</span>, <time datetime="2021-04-28" class="refDate">28 April 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-6man-mtu-option-05">https://datatracker.ietf.org/doc/html/draft-ietf-6man-mtu-option-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.leddy-6man-truncate">[I-D.leddy-6man-truncate]</dt>
        <dd>
<span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Bonica, R.</span>, and <span class="refAuthor">I. Lubashev</span>, <span class="refTitle">"IPv6 Packet Truncation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-leddy-6man-truncate-05</span>, <time datetime="2018-10-10" class="refDate">10 October 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-leddy-6man-truncate-05">https://datatracker.ietf.org/doc/html/draft-leddy-6man-truncate-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.yiakoumis-network-tokens">[I-D.yiakoumis-network-tokens]</dt>
        <dd>
<span class="refAuthor">Yiakoumis, Y.</span>, <span class="refAuthor">McKeown, N.</span>, and <span class="refAuthor">F. Sorensen</span>, <span class="refTitle">"Network Tokens"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-yiakoumis-network-tokens-02</span>, <time datetime="2020-12-22" class="refDate">22 December 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-yiakoumis-network-tokens-02">https://datatracker.ietf.org/doc/html/draft-yiakoumis-network-tokens-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc793">https://datatracker.ietf.org/doc/html/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc4443">https://datatracker.ietf.org/doc/html/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6438">[RFC6438]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">S. Amante</span>, <span class="refTitle">"Using the IPv6 Flow Label for Equal Cost Multipath Routing and Link Aggregation in Tunnels"</span>, <span class="seriesInfo">RFC 6438</span>, <span class="seriesInfo">DOI 10.17487/RFC6438</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc6438">https://datatracker.ietf.org/doc/html/rfc6438</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6936">[RFC6936]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span> and <span class="refAuthor">M. Westerlund</span>, <span class="refTitle">"Applicability Statement for the Use of IPv6 UDP Datagrams with Zero Checksums"</span>, <span class="seriesInfo">RFC 6936</span>, <span class="seriesInfo">DOI 10.17487/RFC6936</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc6936">https://datatracker.ietf.org/doc/html/rfc6936</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7231">[RFC7231]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc7231">https://datatracker.ietf.org/doc/html/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7657">[RFC7657]</dt>
        <dd>
<span class="refAuthor">Black, D., Ed.</span> and <span class="refAuthor">P. Jones</span>, <span class="refTitle">"Differentiated Services (Diffserv) and Real-Time Communication"</span>, <span class="seriesInfo">RFC 7657</span>, <span class="seriesInfo">DOI 10.17487/RFC7657</span>, <time datetime="2015-11" class="refDate">November 2015</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc7657">https://datatracker.ietf.org/doc/html/rfc7657</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8656">[RFC8656]</dt>
      <dd>
<span class="refAuthor">Reddy, T., Ed.</span>, <span class="refAuthor">Johnston, A., Ed.</span>, <span class="refAuthor">Matthews, P.</span>, and <span class="refAuthor">J. Rosenberg</span>, <span class="refTitle">"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"</span>, <span class="seriesInfo">RFC 8656</span>, <span class="seriesInfo">DOI 10.17487/RFC8656</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/rfc8656">https://datatracker.ietf.org/doc/html/rfc8656</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Magnus Westerlund</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:magnus.westerlund@ericsson.com" class="email">magnus.westerlund@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marcus Ihlar</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marcus.ihlar@ericsson.com" class="email">marcus.ihlar@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Zaheduzzaman Sarker</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:zaheduzzaman.sarker@ericsson.com" class="email">zaheduzzaman.sarker@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mirja Kuehlewind</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mirja.kuehlewind@ericsson.com" class="email">mirja.kuehlewind@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
